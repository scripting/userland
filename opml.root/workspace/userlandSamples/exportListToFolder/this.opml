<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- OPML generated by OPML Editor v10.1b19 on Sat, 03 Jun 2017 03:30:21 GMT -->
<opml version="2.0">
	<head>
		<title>workspace.userlandSamples.exportListToFolder</title>
		<dateCreated>Tue, 06 Sep 2011 11:58:15 GMT</dateCreated>
		<dateModified>Sat, 03 Jun 2017 03:30:21 GMT</dateModified>
		<ownerName>Dave Winer</ownerName>
		<ownerId>http://davewiner.com/</ownerId>
		<expansionState>1, 2, 3, 8</expansionState>
		<vertScrollState>1</vertScrollState>
		<windowTop>270</windowTop>
		<windowLeft>1273</windowLeft>
		<windowBottom>794</windowBottom>
		<windowRight>2234</windowRight>
		</head>
	<body>
		<outline text="on exportListToFolder ()">
			<outline text="Changes" isComment="true">
				<outline text="9/6/11; 7:58:18 AM by DW">
					<outline text="Create an outline with a list of parts, bring it to the front and run this script. We'll create a folder containing those parts."/>
					</outline>
				</outline>
			<outline text="local (pc = file.getpathchar (), folder = frontier.pathstring + &quot;Saved Parts&quot; + pc, now = clock.now ())"/>
			<outline text="on saveobject (adr, folder)">
				<outline text="local (suffix = Frontier.getFileSuffix (typeOf (adr^), true))"/>
				<outline text="if suffix != &quot;&quot;">
					<outline text="suffix = &quot;.&quot; + suffix"/>
					</outline>
				<outline text="s = nameof (adr^)"/>
				<outline text="adrParent = parentOf (adr^)"/>
				<outline text="if adrParent != nil">
					<outline text="if (not table.inguestdatabase (adr)) or (adrparent != table.getrootaddress (adr))">
						<outline text="local (dottedname = nameOf (adrParent^) + '.' + s)"/>
						<outline text="if (sizeof (dottedname) + sizeof (suffix) + 1) &lt; 32">
							<outline text="s = dottedname"/>
							</outline>
						</outline>
					</outline>
				<outline text="local (f = folder + s + suffix)"/>
				<outline text="file.surefilepath (f)"/>
				<outline text="export.sendobject (adr, f)"/>
				<outline text="if timemodified (adr) == date (0)">
					<outline text="file.setmodified (f, now)"/>
					<outline text="file.setcreated (f, now)"/>
					</outline>
				<outline text="else">
					<outline text="file.setmodified (f, timemodified (adr))"/>
					<outline text="file.setcreated (f, timecreated (adr))"/>
					</outline>
				</outline>
			<outline text="loop">
				<outline text="local (adr = address (op.getlinetext ()))"/>
				<outline text="saveobject (adr, folder)"/>
				<outline text="if not op.go (down, 1)">
					<outline text="file.openfolder (folder)"/>
					<outline text="break"/>
					</outline>
				</outline>
			</outline>
		<outline text="bundle //test code">
			<outline text="exportListToFolder ()"/>
			</outline>
		</body>
	</opml>
