<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- OPML generated by OPML Editor v10.1b19 on Fri, 02 Jun 2017 18:16:54 GMT -->
<opml version="2.0">
	<head>
		<title>workspace.userlandSamples.exportConfigTable</title>
		<dateCreated>Sat, 14 Dec 2013 12:12:49 GMT</dateCreated>
		<dateModified>Sat, 14 Dec 2013 12:22:32 GMT</dateModified>
		<ownerName>Dave Winer</ownerName>
		<ownerId>http://davewiner.com/</ownerId>
		<expansionState>1, 2, 3, 6, 9, 13, 14, 16, 22</expansionState>
		<vertScrollState>1</vertScrollState>
		<windowTop>282</windowTop>
		<windowLeft>768</windowLeft>
		<windowBottom>918</windowBottom>
		<windowRight>1629</windowRight>
		</head>
	<body>
		<outline text="on exportConfigTables ()">
			<outline text="Changes" isComment="true">
				<outline text="12/14/13; 7:45:33 AM by DW">
					<outline text="Exports all of the sub-tables of config.root to your export folder, user.opmlEditor.prefs.exportFolder, which you should be sure to set before running this script. Very useful to have this kind of backup when re-installing the OPML Editor freshly."/>
					</outline>
				</outline>
			<outline text="local (adr, folder, pc = file.getpathchar ())"/>
			<outline text="bundle //set folder">
				<outline text="if defined (user.opmlEditor.prefs.exportFolder)">
					<outline text="folder = user.opmlEditor.prefs.exportFolder"/>
					</outline>
				<outline text="else">
					<outline text="if not file.getfolderdialog (&quot;Choose a folder to export to:&quot;, @folder)">
						<outline text="return"/>
						</outline>
					<outline text="user.opmlEditor.prefs.exportFolder = folder"/>
					</outline>
				</outline>
			<outline text="for adr in @config">
				<outline text="local (suffix = Frontier.getFileSuffix (typeOf (adr^), true), fname, adrparent)"/>
				<outline text="fname = nameof (adr^)"/>
				<outline text="adrparent = parentOf (adr^)"/>
				<outline text="if adrparent != nil">
					<outline text="if (not table.inguestdatabase (adr)) or (adrparent != table.getrootaddress (adr))">
						<outline text="local (dottedname = nameOf (adrParent^) + '.' + fname)"/>
						<outline text="if (sizeof (dottedname) + sizeof (suffix) + 1) &lt; 32">
							<outline text="fname = dottedname"/>
							</outline>
						</outline>
					</outline>
				<outline text="local (f = folder + &quot;config&quot; + pc + fname + &quot;.&quot; + suffix)"/>
				<outline text="file.surefilepath (f)"/>
				<outline text="msg (f)"/>
				<outline text="export.sendobject (adr, f)"/>
				</outline>
			</outline>
		<outline text="bundle //test code">
			<outline text="exportConfigTables ()"/>
			</outline>
		</body>
	</opml>
