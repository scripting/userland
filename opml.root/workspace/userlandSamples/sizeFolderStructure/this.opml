<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- OPML generated by OPML Editor v10.1b19 on Sat, 03 Jun 2017 03:29:19 GMT -->
<opml version="2.0">
	<head>
		<title>workspace.userlandSamples.sizeFolderStructure</title>
		<dateCreated>Sat, 27 Nov 2010 21:59:45 GMT</dateCreated>
		<dateModified>Sat, 03 Jun 2017 03:29:19 GMT</dateModified>
		<ownerName>Dave Winer</ownerName>
		<ownerId>http://davewiner.com/</ownerId>
		<expansionState>1, 2, 3, 5, 10, 13, 18</expansionState>
		<vertScrollState>1</vertScrollState>
		<windowTop>221</windowTop>
		<windowLeft>700</windowLeft>
		<windowBottom>895</windowBottom>
		<windowRight>1717</windowRight>
		</head>
	<body>
		<outline text="on sizeFolderStructure (folder, adroutline)">
			<outline text="Changes" isComment="true">
				<outline text="11/27/10; 5:59:50 PM by DW">
					<outline text="I always wondered where all the files were in a huge folder, like the one that stores all the static files for scripting.com. This script walks the folder structure recursively, and on each folder tells you how many files it contains, at all levels, and how much space they occupy. That way you can quickly zoom in on where the big stuff is. "/>
					</outline>
				</outline>
			<outline text="bundle //set up outline">
				<outline text="new (outlinetype, adroutline)"/>
				<outline text="target.set (adroutline)"/>
				<outline text="op.setlinetext (file.filefrompath (folder))"/>
				<outline text="edit (adroutline)"/>
				</outline>
			<outline text="on dofolder (folder, adrdata=nil)">
				<outline text="local (f, dir = right)"/>
				<outline text="if adrdata != nil">
					<outline text="new (tabletype, adrdata)"/>
					<outline text="adrdata^.ctfiles = 0"/>
					<outline text="adrdata^.size = 0"/>
					</outline>
				<outline text="fileloop (f in folder)">
					<outline text="if file.isfolder (f)">
						<outline text="local (data, fname = file.filefrompath (f))"/>
						<outline text="op.insert (fname, dir); dir = down"/>
						<outline text="dofolder (f, @data)"/>
						<outline text="op.setlinetext (fname + &quot; (&quot; + string.gigabytestring (data.size) + &quot; -- &quot; + string.addcommas (data.ctfiles) + &quot;)&quot;)"/>
						<outline text="if adrdata != nil">
							<outline text="adrdata^.ctfiles = adrdata^.ctfiles + data.ctfiles"/>
							<outline text="adrdata^.size = adrdata^.size + data.size"/>
							</outline>
						</outline>
					<outline text="else">
						<outline text="if adrdata != nil">
							<outline text="adrdata^.ctfiles++"/>
							<outline text="adrdata^.size = adrdata^.size + file.size (f)"/>
							</outline>
						</outline>
					</outline>
				<outline text="if dir == down">
					<outline text="op.go (left, 1)"/>
					<outline text="op.collapse ()"/>
					</outline>
				</outline>
			<outline text="dofolder (folder)"/>
			</outline>
		<outline text="bundle //test code">
			<outline text="sizeFolderStructure (&quot;Ohio:Server Backups:static sites:scripting.com:&quot;, @scratchpad.folderstructure)"/>
			</outline>
		</body>
	</opml>
