<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- OPML generated by OPML Editor v10.1b19 on Fri, 02 Jun 2017 18:16:54 GMT -->
<opml version="2.0">
	<head>
		<title>workspace.userlandSamples.findBigThings</title>
		<dateCreated>Wed, 10 Jan 2001 11:13:53 GMT</dateCreated>
		<dateModified>Tue, 09 Jun 2009 13:12:50 GMT</dateModified>
		<ownerName>Dave Winer</ownerName>
		<ownerId>http://davewiner.com/</ownerId>
		<expansionState>1, 2, 3, 8, 11, 12, 13, 14, 16, 17, 22, 23, 30, 33, 41</expansionState>
		<vertScrollState>1</vertScrollState>
		<windowTop>83</windowTop>
		<windowLeft>640</windowLeft>
		<windowBottom>1041</windowBottom>
		<windowRight>1398</windowRight>
		</head>
	<body>
		<outline text="on findBigThingsInTable (adrroottable = @root)" created="Sat, 26 Jan 2008 16:53:42 GMT">
			<outline text="Changes" isComment="true" created="Sat, 26 Jan 2008 16:54:23 GMT">
				<outline text="6/9/09; 9:11:53 AM by DW">
					<outline text="Getting errors on table.inguestdatabase call. Since it's only for displaying progress messages, I put it inside a try so it wouldn't halt the scan."/>
					</outline>
				<outline text="4/26/09; 10:20:45 AM by DW">
					<outline text="I wasted the better part of a week trying to figure out why one of my servers was flatlining. It turns out a random table in opmlCommunityServerData.root was expanded. This script was only looking in the user sub-table of opml.root. So this time (it's happened before) -- I'm going to invest a couple of hours into making this script look in all open database files. "/>
					</outline>
				<outline text="1/26/08; 8:54:28 AM by DW" created="Sat, 26 Jan 2008 16:54:26 GMT">
					<outline text="Add a paramenter, the root of the table you're going to look in. Makes it possible to be selective where you search." created="Sat, 26 Jan 2008 16:54:28 GMT"/>
					</outline>
				<outline text="1/10/01; 7:57:47 AM by DW" isComment="true">
					<outline text="Visit all objects in all open databases looking for tables and outlines that have more than 1000 elements. Big outlines really slow things down. You might want to know where your big tables are."/>
					</outline>
				</outline>
			<outline text="on dotable (adrtable)">
				<outline text="on addadr (adr)">
					<outline text="local (s = string (adr))"/>
					<outline text="local (pattern = &quot;\&quot;].&quot;)"/>
					<outline text="local (ix = string.patternmatch (pattern, s))"/>
					<outline text="if ix &gt; 0">
						<outline text="s = string.delete (s, 1, ix + sizeof (pattern) - 1)"/>
						</outline>
					<outline text="op.insert (s + &quot; (&quot; + sizeof (adr^) + &quot;)&quot;, insertdir); insertdir = down"/>
					</outline>
				<outline text="local (adr)"/>
				<outline text="for adr in adrtable">
					<outline text="case typeof (adr^)">
						<outline text="tabletype">
							<outline text="if sizeof (adr^) &gt; marksize">
								<outline text="addadr (adr)"/>
								</outline>
							<outline text="if (++ct % 1000) == 0">
								<outline text="try //6/9/09 by DW">
									<outline text="local (s = string (adr))"/>
									<outline text="if table.inguestdatabase (adr)">
										<outline text="if s contains &quot;]&quot;">
											<outline text="local (ix = string.patternmatch (&quot;]&quot;, s))"/>
											<outline text="s = string.delete (s, 1, ix+1)" isBreakpoint="true"/>
											</outline>
										</outline>
									<outline text="msg (ct + &quot;: &quot; + s)"/>
									</outline>
								</outline>
							<outline text="dotable (adr)"/>
							</outline>
						<outline text="outlinetype">
							<outline text="if sizeof (adr^) &gt; marksize" isBreakpoint="true">
								<outline text="addadr (adr)"/>
								</outline>
							</outline>
						</outline>
					</outline>
				<outline text="return (true)"/>
				</outline>
			<outline text="dotable (adrroottable)"/>
			<outline text="op.firstsummit ()"/>
			<outline text="edit (adroutline)"/>
			<outline text="msg (&quot;&quot;)"/>
			</outline>
		<outline text="bundle //body" created="Sat, 26 Jan 2008 16:54:09 GMT">
			<outline text="local (marksize = 1000, ct = 0)"/>
			<outline text="local (adroutline = @scratchpad.bigOutlines, adrfile, insertdir)"/>
			<outline text="bundle //set up the outline">
				<outline text="new (outlinetype, adroutline); "/>
				<outline text="edit (adroutline)"/>
				<outline text="window.setsize (adroutline, 700, 500)"/>
				<outline text="window.setposition (adroutline, 250, 250)"/>
				<outline text="target.set (adroutline)"/>
				<outline text="op.firstsummit ()"/>
				<outline text="op.setlinetext (&quot;Big tables and outlines on &quot; + clock.now () + &quot;:&quot;)"/>
				</outline>
			<outline text="for adrfile in @system.compiler.files">
				<outline text="local (f = nameof (adrfile^), adrtable = @[f])"/>
				<outline text="op.firstsummit ()"/>
				<outline text="op.insert (f - frontier.pathstring, right); insertdir = right"/>
				<outline text="findBigThingsInTable (adrtable)" isBreakpoint="true" created="Sat, 26 Jan 2008 16:54:14 GMT"/>
				<outline text="op.go (left, 1)"/>
				</outline>
			<outline text="op.insert (&quot;user&quot;, right); insertdir = right"/>
			<outline text="findBigThingsInTable (@user)" created="Sat, 26 Jan 2008 16:54:14 GMT"/>
			</outline>
		</body>
	</opml>
