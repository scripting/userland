<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- OPML generated by OPML Editor v10.1b19 on Sat, 03 Jun 2017 03:30:26 GMT -->
<opml version="2.0">
	<head>
		<title>workspace.userlandSamples.getGoogleMovies</title>
		<dateCreated>Mon, 19 Nov 2012 17:07:31 GMT</dateCreated>
		<dateModified>Sat, 03 Jun 2017 03:30:26 GMT</dateModified>
		<ownerName>Dave Winer</ownerName>
		<ownerId>http://davewiner.com/</ownerId>
		<expansionState>1, 2, 3, 7, 14, 15, 31</expansionState>
		<vertScrollState>1</vertScrollState>
		<windowTop>110</windowTop>
		<windowLeft>434</windowLeft>
		<windowBottom>887</windowBottom>
		<windowRight>1481</windowRight>
		</head>
	<body>
		<outline text="on getGoogleMovies (zip, adrmoviestable)">
			<outline text="Changes" isComment="true">
				<outline text="11/19/12; 1:07:35 PM by DW">
					<outline text="A sample script that tells you what movies are playing nearby now. Unfortunately the API doesn't tell you where they're playing. Oh well.">
						<outline text="http://worknotes.scripting.com/november2012/111912ByDw/googleMoviesApi"/>
						</outline>
					</outline>
				</outline>
			<outline text="local (xmltext, xstruct, i = 0, adrreply, adrmovies, adrmovie, fldone = false, url)"/>
			<outline text="new (tabletype, adrmoviestable)"/>
			<outline text="while not fldone">
				<outline text="url = &quot;http://www.google.com/ig/api?movies=&quot; + zip + &quot;&amp;start=&quot; + 3 * i++"/>
				<outline text="xmltext = tcp.httpreadurl (url, 3, false)"/>
				<outline text="msg (url)"/>
				<outline text="xml.compile (xmltext, @xstruct)"/>
				<outline text="adrreply = xml.getaddress (@xstruct, &quot;xml_api_reply&quot;)"/>
				<outline text="adrmovies = xml.getaddress (adrreply, &quot;movies&quot;)"/>
				<outline text="for adrmovie in adrmovies">
					<outline text="if nameof (adrmovie^) endswith &quot;movie&quot;">
						<outline text="local (adrsub, title)"/>
						<outline text="on getvalue (name)">
							<outline text="try">
								<outline text="local (adrval)"/>
								<outline text="adrval = xml.getaddress (adrmovie, name)"/>
								<outline text="return (adrval^.[&quot;/atts&quot;].data)"/>
								</outline>
							<outline text="else">
								<outline text="return (&quot;&quot;)"/>
								</outline>
							</outline>
						<outline text="title = getvalue (&quot;title&quot;)"/>
						<outline text="if sizeof (title) == 0">
							<outline text="fldone = true"/>
							<outline text="break"/>
							</outline>
						<outline text="adrsub = @adrmoviestable^.[title]"/>
						<outline text="new (tabletype, adrsub)"/>
						<outline text="adrsub^.movieId = getvalue (&quot;movie_id&quot;)"/>
						<outline text="adrsub^.length = getvalue (&quot;length&quot;)"/>
						<outline text="adrsub^.genre = getvalue (&quot;genre&quot;)"/>
						<outline text="adrsub^.mpaaRating = getvalue (&quot;mpaarating&quot;)"/>
						<outline text="adrsub^.numreviews = getvalue (&quot;num_reviews&quot;)"/>
						<outline text="adrsub^.reviewsUrl = getvalue (&quot;reviews_url&quot;)"/>
						<outline text="adrsub^.imgdbUrl = getvalue (&quot;imgdb_url&quot;)"/>
						<outline text="adrsub^.landingpageUrl = getvalue (&quot;landingpage_url&quot;)"/>
						<outline text="adrsub^.reviewsRatingPercent = getvalue (&quot;reviews_rating_percent&quot;)"/>
						</outline>
					</outline>
				</outline>
			</outline>
		<outline text="bundle //test code">
			<outline text="getGoogleMovies (&quot;10003&quot;, @scratchpad.mygooglemovies)"/>
			<outline text="edit (@scratchpad.mygooglemovies)"/>
			</outline>
		</body>
	</opml>
