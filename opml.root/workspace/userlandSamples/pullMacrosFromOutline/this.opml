<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- OPML generated by OPML Editor v10.1b19 on Fri, 02 Jun 2017 18:16:57 GMT -->
<opml version="2.0">
	<head>
		<title>workspace.userlandSamples.pullMacrosFromOutline</title>
		<dateCreated>Thu, 26 Apr 2012 16:19:47 GMT</dateCreated>
		<dateModified>Thu, 26 Apr 2012 16:32:53 GMT</dateModified>
		<ownerName>Dave Winer</ownerName>
		<ownerId>http://davewiner.com/</ownerId>
		<expansionState>1, 2, 3, 11, 17</expansionState>
		<vertScrollState>1</vertScrollState>
		<windowTop>94</windowTop>
		<windowLeft>951</windowLeft>
		<windowBottom>606</windowBottom>
		<windowRight>2076</windowRight>
		</head>
	<body>
		<outline text="on pullMacrosFromOutline (s)">
			<outline text="Changes" isComment="true">
				<outline text="4/26/12; 12:19:51 PM by DW">
					<outline text="Use this script to get a list of macros that appear in an outline. To use, open the outline containing the macros, then open this script and click the Run button. A list of macros will open. "/>
					</outline>
				</outline>
			<outline text="local (adroutline = @scratchpad.macros, macros, oldtarget)"/>
			<outline text="new (tabletype, @macros)"/>
			<outline text="loop">
				<outline text="local (ix = string.patternmatch (&quot;&lt;%&quot;, s), macro)"/>
				<outline text="if ix == 0">
					<outline text="break"/>
					</outline>
				<outline text="s = string.delete (s, 1, ix-1)"/>
				<outline text="ix = string.patternmatch (&quot;%&gt;&quot;, s)"/>
				<outline text="if ix == 0">
					<outline text="break"/>
					</outline>
				<outline text="macros.[string. mid (s, 1, ix+1)] = true" isBreakpoint="true"/>
				<outline text="s = string.delete (s, 1, ix+1)"/>
				</outline>
			<outline text=""/>
			<outline text="new (outlinetype, adroutline)"/>
			<outline text="oldtarget = target.set (adroutline)"/>
			<outline text="for adrmacro in @macros">
				<outline text="op.insert (nameof (adrmacro^), down)"/>
				</outline>
			<outline text="op.firstsummit ()"/>
			<outline text="op.deleteline ()"/>
			<outline text="edit (adroutline)"/>
			<outline text="target.set (oldtarget)"/>
			</outline>
		<outline text="bundle //test code">
			<outline text="local (adrfrontwindow = address (window.frontmost ()))"/>
			<outline text="pullMacrosFromOutline (string (adrfrontwindow^))"/>
			</outline>
		</body>
	</opml>
